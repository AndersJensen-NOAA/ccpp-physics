/**
\page v6phys_enh_page GFS Prototype 8 Physics Enhancements

\section CA_p8 Cellular Automata in the ufs-weather-model
\author Lisa Bengtsson (NOAA Physical Sciences Laboratory): Lisa.Bengtsson@noaa.gov

\b Scientific \b background:

Cumulus clouds in the atmosphere can organize into a variety of sizes, ranging from small fair‐weather cumulus clouds, rain showers and thunderstorms, to larger scale weather systems. In weather and climate models, such organization is traditionally not well-represented as the motions associated with cumulus clouds are generally too small to be resolved by the numerical model. In this scheme we use a stochastic cellular automaton (CA), a mathematical model often used to describe self‐organizing behavior in physical systems to represent the effects of convective organization. The scheme addresses the effect of convective organization in a bulk-plume cumulus convection parameterizations (saSAS), where this type of organization has to be represented in terms of how the resolved flow would “feel” convection if more coherent structures were present on the subgrid.  
In addition, for longer range forecasts (seasonal, decadal, climate), the relevance of stochastic cumulus convection in numerical models can also be discussed in terms of noise induced forcing. As an example, on the time scale of organized convectively coupled waves, the small scale individual convective plumes grow and decay so rapidly that they are not predictable on time-scales longer than a few hours, whereas the organized larger scale convectively coupled wave envelope can have a deterministic limit of predictability of about two weeks. Thus, for longer range forecasts, individual convective plumes can be viewed as stochastic noise - they can have an impact on the convectively coupled waves (due to noise forcing), but they are not predictable on their own. By providing the CA with a stochastic initialization, the effect of stochastic cumulus convection is also represented by the scheme. 
The scientific motivation for the scheme, the CA rulesets explored, and the impact on convectively coupled equatorial waves can be found in the following references; Bengtsson et al. 2011, Bengtsson et al. 2013, Bengtsson and Kornich (2016), Bengtsson et al 2019, and Bengtsson et al. 2021. 

\b Technical \b remarks:

The CA source code is located in the stochastic physics submodule in the ufs-weather-model: https://github.com/noaa-psd/stochastic_physics . The main call to the CA routines are made from FV3/stochastic_physics_driver.F90. 

There are currently two options to evolve the CA (can be done simultaneously); (ca_global) a large scale global pattern which evolves the ruleset according to game of life with cell history, or (ca_sgs) a sub-grid scale pattern which is conditioned on a forcing from the atmospheric model. The two options are controlled by namelist (see below) and are evolved in cellular_automata_globa.F90 and cellular_automata_sgs.F90 respectively. Both approaches use the main CA module update_ca.F90 to evolve the CA in time. Since the CA needs to know about its neighborhood it uses the halo information to gather the state in adjacent MPI domains and/or adjacent cube sphere interfaces. 


\section cumu_p8 P8 Physics Updates in GFS Cumulus Convection
\author Jongil Han (NCEP Environmental Modeling Center): Jongil.Han@noaa.gov

- To enhance the surface-based convective available potential energy (CAPE), more strict convection trigger conditions are applied.
- Enhanced downdraft detrainments start from 60mb above the ground surface rather than from the cloud base.
- Reduced rain evaporation with the removal of wind shear dependency, which helps to reduce cold bias in tropospheric temperature profile especially over Tropics.
- Separation cloud depth of deep and shallow convection is increased to 200 hPa from 150 hPa.
- Updraft entrainment rates for moisture, hydrometeors, and tracers are increased by about 30%.
- A positive definite TVD (Total Variation Diminishing) mass-flux transport scheme for moisture, hydrometeors and tracers and a method for removing negative tracer mixing ratio values have been implemented.


\section pbl_p8 P8 Physics Updates in GFS PBL and Free Atmospheric Turbulence Mixing
\author Jongil Han (NCEP Environmental Modeling Center): Jongil.Han@noaa.gov

- Wind shear effect in characteristic mixing length calculation is included, which reduces the mixing length in a strong shear environment such as a hurricane.
- To better predict surface inversion as well as capping inversion near the PBL top, background diffusivity in the inversion layers is reduced as a function of surface roughness and green vegetation fraction.
- To reduce the PBL overgrowth, the PBL updraft overshoot is not only limited by bulk Richardson number-based-PBL depth, but the virtual potential temperature at top of the surface layer rather than that at the model first layer is also used as the near-surface virtual potential temperature in the bulk-Richardson number computation. This helps to largely suppress the unrealistic widespread popcorn-like precipitation.
- Updraft entrainment rates for moisture, hydrometeors, and tracers are increased by about 30%.
- A positive definite TVD mass-flux transport scheme for moisture, hydrometeors, and tracers and a method for removing negative tracer mixing ratio values have been implemented.


\section sfc_p8 P8 Physics Updates in GFS Surface Layer Physics
\author Jongil Han (NCEP Environmental Modeling Center): Jongil.Han@noaa.gov

- New canopy heat storage parameterization is implemented, which is achieved by reducing sensible heat flux into the PBL scheme as a function of surface roughness and vegetation fraction and helps to reduce nighttime cold and daytime warm 2-meter temperature biases over forested regions. 
- A sea spray effect parameterization is included to enhance sensible and latent heat fluxes, especially for strong wind conditions.  
- To better represent sub-grid scale turbulence variability in the surface layer, a new parameterization for maximum surface layer stability parameter is developed as an inverse function of the background turbulent eddy diffusivity. 
- Thermal roughness length calculation over land has been modified.


\b References

Han. J., W. Li, F. Yang, E. Strobach, W. Zheng, and R. Sun, 2022: Updates in the NCEP GFS cumulus convection, vertical turbulent mixing, and surface layer physics. NCEP Office Note 505. 

Han. J., F. Yang, R. Montuoro, W. Li, and R. Sun, 2022: Implementation of a positive definite mass-flux scheme and a method for removing the negative tracers in the NCEP GFS planetary boundary layer and cumulus convection schemes. NCEP Office Note 506. 



\section  reeng_rcld Reengineering of Cloud Property Computation Routines
\author Qingfu Liu (NCEP Environmental Modeling Center): Qingfu.Liu@noaa.gov

Requests have been made by many physics developers and users to rewrite
the cloud routines (progcldXXX) for radiation computation in the program
radiation_clouds.f. Those cloud subroutines are very similar, and
have many lines of common code. We modified the radiation_clouds.f module, 
and includes all the calculations of the cloud properties to a new subroutine 
radiation_clouds_prop. We also moved the common code from subroutines 
progcldXXX to this new subroutine. Subroutine radiation_clouds_prop can be 
called by RRTMG and RRTMGP. A single call to the subroutine 
radiation_clouds_prop can connect to the calculations of the cloud 
radiation properties for all the microphysics schemes.

Summary of the major changes:
- radiation_clouds.f

 A new subroutine “radiation_clouds_prop” is added in the program radiation_clouds.f. This new subroutine contains all the calculations of the cloud radiation properties for all the microphysics. Rename all the subroutines “progcldXXX” to new names based on the input variables imp_physics_XXX, and remove the inactive subroutines from file radiation_clouds.f
 -       'progcld1'    	   --- > progcld_zhao_carr
 -       'progcld3'    	   --- > progcld_zhao_carr_pdf
 -       'progcld4'    	   --- > progcld_gfdl_lin
 -       'progcld5'    	   --- > progcld_fer_hires
 -       'progcld6'        --- > progcld_thompson_wsm6
 -       'progclduni'	   --- > progclduni
 -       'progcld_thompson'--- > progcld_thompson

- GFS_rrtmg_pre.F90

Removed the “progcldXXX” subroutine calls, and replaced them with a single subroutine call to “radiation_clouds_prop”. 

- radiation_cloud_overlap.F90

Replace the subroutine “get_alpha_exp” with “get_alpha_exper”. The new subroutine revises alpha for exponential random cloud overlap option. This new subroutine is used in programs GFS_rrtmgp_cloud_overlap_pre.F90 and GFS_rrtmgp_gfdlmp_pre.F90.

- Subroutine getml() has been modified. The subroutine computes low, mid, high, total and boundary clouds, and is used in GFS_cloud_diagnostics.F90.

\todo P8 updates in Thompson MP
\todo P8 updates in NOAHMP



*/
